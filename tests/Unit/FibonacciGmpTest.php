<?php

namespace Tests\Unit;

use Exception;
use PHPUnit\Framework\TestCase;

class FibonacciGmpTest extends TestCase
{
    /**
     * @throws Exception
     */
    public function testFibonacciRepeatFormulaGMPReturnsCorrectResults()
    {
        $results = [
            6  => '8',
            9  => '34',
            18 => '2584',
            20 => '6765',
            25 => '75025',
            9999 => '20793608237133498072112648988642836825087036094015903119682945866528501423455686648927456034305' .
            '22651559175734329719015801062479426725097317613381017990273803823178974834623555648319143159192453239442' .
            '00280678103204087244146934628490626683870833080482509206544933408787332263775808474463248737976037347946' .
            '48258113858631550404081017260381202919943892370942852601647398213554479081823593715429566945149312993664' .
            '84677909043779928477367537928427066017513466483326637769864201210689135579114187277693408080350495679409' .
            '46482928805660563647181876626689707585373833526774208355741559456585420036347653245410061210124467856891' .
            '71494803262408602693091211601973938229446636049901531963286159699077880427720289235539329671877182915643' .
            '41907918652511867885682160089752017107049943765706734240087108390881180097625972743182053955425686946081' .
            '53559184582533982343823604357627598231798961167484242695459246332046141379928508143520187384809235815539' .
            '88990897151469406131695614497783720743461373756218685106856826090696339815490921253714537241866911604250' .
            '59735374782373326817818219850924022695582641601669008474981607284358248861318482990538315018004784435375' .
            '15542015738331055219809981238332532612286898240517778465884610797908078283671323847984517940110765690575' .
            '22158680378961532160858387223882974380483931929541222100800313580688585002598879566463221427820448492565' .
            '07310659580883740164899642356338610978204563412246787292184560640917436063561821688381256232166444282295' .
            '25375774927153653211342045306867424354545051032697681443701184949063902549349423589040315098773697224370' .
            '53383165360388595116980245927935225901537634925654872380877183008301074569444002426436414756905094535072' .
            '80476468449210568002473991449055590439136921869638709291818924615710345038705022930060324161141070745396' .
            '00801709282779518347632167052424858208014238665266338160829214428830954632590804718193292017101478280252' .
            '21385656340207489796317663278872207607791034431700112753558813478888727503825389066823098683355695718137' .
            '86788298211171079642270677853691319234273336455672792801895398915310604737974128079409163942990879665029' .
            '4603536651238230626'
        ];

        foreach ($results as $input => $expected) {
            $actual = gmp_strval(fibonacciRepeatedSeriesGMP($input));
            $this->assertEquals($expected, $actual, "Failed asserting fibonacciRepeatedSeriesGMP($input)");
        }
    }

    /**
     * @throws Exception
     */
    public function testFibonacciStraightGMPReturnsCorrectResults()
    {
        $results = [
            6  => '8',
            9  => '34',
            18 => '2584',
            20 => '6765',
            25 => '75025',
            9999 => '20793608237133498072112648988642836825087036094015903119682945866528501423455686648927456034305' .
                '22651559175734329719015801062479426725097317613381017990273803823178974834623555648319143159192453239442' .
                '00280678103204087244146934628490626683870833080482509206544933408787332263775808474463248737976037347946' .
                '48258113858631550404081017260381202919943892370942852601647398213554479081823593715429566945149312993664' .
                '84677909043779928477367537928427066017513466483326637769864201210689135579114187277693408080350495679409' .
                '46482928805660563647181876626689707585373833526774208355741559456585420036347653245410061210124467856891' .
                '71494803262408602693091211601973938229446636049901531963286159699077880427720289235539329671877182915643' .
                '41907918652511867885682160089752017107049943765706734240087108390881180097625972743182053955425686946081' .
                '53559184582533982343823604357627598231798961167484242695459246332046141379928508143520187384809235815539' .
                '88990897151469406131695614497783720743461373756218685106856826090696339815490921253714537241866911604250' .
                '59735374782373326817818219850924022695582641601669008474981607284358248861318482990538315018004784435375' .
                '15542015738331055219809981238332532612286898240517778465884610797908078283671323847984517940110765690575' .
                '22158680378961532160858387223882974380483931929541222100800313580688585002598879566463221427820448492565' .
                '07310659580883740164899642356338610978204563412246787292184560640917436063561821688381256232166444282295' .
                '25375774927153653211342045306867424354545051032697681443701184949063902549349423589040315098773697224370' .
                '53383165360388595116980245927935225901537634925654872380877183008301074569444002426436414756905094535072' .
                '80476468449210568002473991449055590439136921869638709291818924615710345038705022930060324161141070745396' .
                '00801709282779518347632167052424858208014238665266338160829214428830954632590804718193292017101478280252' .
                '21385656340207489796317663278872207607791034431700112753558813478888727503825389066823098683355695718137' .
                '86788298211171079642270677853691319234273336455672792801895398915310604737974128079409163942990879665029' .
                '4603536651238230626'
        ];

        foreach ($results as $input => $expected) {
            $actual = gmp_strval(fibonacciStraightGMP($input));
            $this->assertEquals($expected, $actual, "Failed asserting fibonacciStraightGMP($input)");
        }
    }

    /**
     * @throws Exception
     */
    public function testFibonacciGMPInputGreaterOrEqualToZero()
    {
        $this->expectException(Exception::class);
        $this->expectExceptionMessage('The input value must be >= 0.');
        fibonacciRepeatedSeriesGMP(-1);
    }

    /**
     * @throws Exception
     */
    public function testFibonacciStraightGMPInputGreaterOrEqualToZero()
    {
        $this->expectException(Exception::class);
        $this->expectExceptionMessage('The input value must be >= 0.');
        fibonacciStraightGMP(-1);
    }
}
